Portions of the code are taken from
http://development.rc.ucl.ac.uk/training/engineering